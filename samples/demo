#!/bin/sh -e
# Demo config module. This is more a regression/stress test than anything.

# Note this stanza is only here to make this script work in an uninstalled
# debconf source tree, and is not needed in production code.
PATH=$PATH:.
if [ -e confmodule ]; then
	. confmodule                                                     
else                                                                            
	. /usr/share/debconf/confmodule                                         
fi 

db_version 2.0
db_capb backup
db_title Demo

# This implements a simple state machine so the back button can be handled.
stage=1
while [ "$stage" != 0 -a "$stage" != 6 ]; do
	case $stage in
	1)
		db_input high demo/boolean || true
	;;
	2)
		db_input low demo/multiselect || true
	;;
	3)
		db_subst demo/select colors red, Yellow, green
		db_input critical demo/string || true
		db_input low demo/password || true
		db_input low demo/text || true
		db_input low demo/select || true
	;;
	4)
		db_get demo/select
		db_beginblock
		db_input low demo/boolean || true
		db_input low demo/boolean || true
		db_endblock
	;;
	5)
		db_input low demo/note || true
		db_fset demo/boolean isdefault true
		db_input high demo/boolean || true
	;;
	esac
	
	if db_go; then
		stage=`expr $stage + 1`
	else
		stage=`expr $stage - 1`
	fi
	echo "ON STAGE: $stage"
done

# This is EVIL, never echo in your own config scripts!
db_get demo/text
echo $RET
db_get demo/boolean
echo $RET
db_get demo/multiselect
echo $RET

